<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dan Vatterott</title>
  <meta name="author" content="Dan Vatterott">




  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="https://danvatterott.com/favicon.png" rel="icon">

  <link href="https://danvatterott.com/theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">

  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="https://danvatterott.com/">Dan Vatterott</a></h1>
    <h2>Data Scientist</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>


<ul class="main-navigation">
    <li><a href="/">Home</a></li>
    <li><a href="/about-me.html">About Me</a></li>
    <li><a href="/publications.html">Publications</a></li>
    <li><a href="/Vatterott_Resume.pdf">Resume</a></li>
    <li><a href="/my-reads.html">My Reads</a></li>
    <li><a href="/presentations.html">Presentations</a></li>
    <li><a href="/blog.html">Blog</a></li>
    <li><a href="/archives.html">Archive</a></li>
</ul></nav>
  <div id="main">
    <div id="content">
<div class="blog-index">
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://danvatterott.com/modeling-the-relative-speed-of-hot-wheels-cars.html">Modeling the relative speed of Hot Wheels Cars</a>
      </h1>
    <p class="meta">
<time datetime="2025-02-01T08:49:00-06:00" pubdate>Sat 01 February 2025</time>    </p>
</header>

  <div class="entry-content"><p>I recently came across a really interesting modeling problem when playing with my kids. It all started when my 5yr old received this <a href="https://www.amazon.com/Hot-Wheels-Ultimate-Transforms-Stomping/dp/B0BN15GCB7/">Hot Wheels T-Rex Transporter</a>.</p>
<div>
  <div float:left>
    <img src="https://danvatterott.com/images/misc/hot_wheels_dino1.jpeg" />
  </div>
  <div float:left>
    <img src="https://danvatterott.com/images/misc/hot_wheels_dino2.jpeg" />
  </div>
</div>

<p>The transporter comes with a race-track where the winner triggers a trap door, dropping the loser to the ground. Obviously our first task …</p></div>
  <footer>
    <a rel="full-article" href="https://danvatterott.com/modeling-the-relative-speed-of-hot-wheels-cars.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://danvatterott.com/data-onboarding-checklist.html">Data Onboarding Checklist</a>
      </h1>
    <p class="meta">
<time datetime="2021-10-10T10:36:37-05:00" pubdate>Sun 10 October 2021</time>    </p>
</header>

  <div class="entry-content"><p>I'm a checklist addict. While our team has a document on acquiring different accounts, reviewing our workflows, reviewing code repos etc., this document doesn't provide any prioritization.</p>
<p>I created the following checklist (markdown) to give a condensed view of what a manager and new hire should accomplish by the end …</p></div>
  <footer>
    <a rel="full-article" href="https://danvatterott.com/data-onboarding-checklist.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://danvatterott.com/posting-collections-as-hive-tables.html">Posting Collections as Hive Tables</a>
      </h1>
    <p class="meta">
<time datetime="2020-08-10T20:03:43-05:00" pubdate>Mon 10 August 2020</time>    </p>
</header>

  <div class="entry-content"><p>I was recently asked to post a series of parquet collection as tables so analysts could query them in SQL. This should be straight forward, but it took me awhile to figure out. Hopefully, you find this post before spending too much time on such an easy task.</p>
<p>You should …</p></div>
  <footer>
    <a rel="full-article" href="https://danvatterott.com/posting-collections-as-hive-tables.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://danvatterott.com/balancing-model-weights-in-pyspark.html">Balancing Model Weights in PySpark</a>
      </h1>
    <p class="meta">
<time datetime="2019-11-18T18:57:03-06:00" pubdate>Mon 18 November 2019</time>    </p>
</header>

  <div class="entry-content"><p><a href="https://www.jeremyjordan.me/imbalanced-data/">Imbalanced classes</a> is a common problem. Scikit-learn provides an easy fix - "balancing" class weights. This makes models more likely to predict the less common classes (e.g., <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html">logistic regression</a>).</p>
<p>The PySpark ML API doesn't have this same functionality, so in this blog post, I describe how to balance class weights …</p></div>
  <footer>
    <a rel="full-article" href="https://danvatterott.com/balancing-model-weights-in-pyspark.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://danvatterott.com/creating-a-cdf-in-pyspark.html">Creating a CDF in PySpark</a>
      </h1>
    <p class="meta">
<time datetime="2019-08-26T19:36:15-05:00" pubdate>Mon 26 August 2019</time>    </p>
</header>

  <div class="entry-content"><p><a href="https://en.wikipedia.org/wiki/Cumulative_distribution_function">CDFs</a> are a useful tool for understanding your data. This tutorial will demonstrate how to create a CDF in PySpark.</p>
<p>I start by creating normally distributed, fake data.</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="w"> </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="n">SparkSession</span>
<span class="w"> </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark</span><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="n">SparkContext</span>
<span class="w"> </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">F</span>
<span class="w"> </span><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark …</span></code></pre></div></div>
  <footer>
    <a rel="full-article" href="https://danvatterott.com/creating-a-cdf-in-pyspark.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://danvatterott.com/limiting-cardinality-with-a-pyspark-custom-transformer.html">Limiting Cardinality with a PySpark Custom Transformer</a>
      </h1>
    <p class="meta">
<time datetime="2019-07-12T06:30:28-05:00" pubdate>Fri 12 July 2019</time>    </p>
</header>

  <div class="entry-content"><p>When onehot-encoding columns in pyspark, <a href="https://livebook.datascienceheroes.com/data-preparation.html#high_cardinality_descriptive_stats">column cardinality</a> can become a problem. The size of the data often leads to an enourmous number of unique values. If a minority of the values are common and the majority of the values are rare, you might want to represent the rare values as …</p></div>
  <footer>
    <a rel="full-article" href="https://danvatterott.com/limiting-cardinality-with-a-pyspark-custom-transformer.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://danvatterott.com/are-some-mlb-players-more-likely-to-hit-into-errors-statistics.html">Are Some MLB Players More Likely To Hit Into Errors: Statistics</a>
      </h1>
    <p class="meta">
<time datetime="2019-06-04T20:04:31-05:00" pubdate>Tue 04 June 2019</time>    </p>
</header>

  <div class="entry-content"><p>In a <a href="https://danvatterott.com/are-some-mlb-players-more-likely-to-hit-into-errors-than-others-data-munging.html">previous post</a>, I described how to download and clean data for understanding how likely a baseball player is to hit into an error given that they hit the ball into play.</p>
<p>This analysis will statistically demonstrate that some players are more likely to hit into errors than others …</p></div>
  <footer>
    <a rel="full-article" href="https://danvatterott.com/are-some-mlb-players-more-likely-to-hit-into-errors-statistics.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://danvatterott.com/data-science-lessons-learned-the-hard-way-coding.html">Data Science Lessons Learned the Hard Way: Coding</a>
      </h1>
    <p class="meta">
<time datetime="2019-05-19T08:44:27-05:00" pubdate>Sun 19 May 2019</time>    </p>
</header>

  <div class="entry-content"><p>You could summarize this post as "you will never regret good code practices" or "no project is too small for good code practices".</p>
<p>You might think these recommendations are not worth the time when a project seems small, but projects often grow over time. If you use good practices from …</p></div>
  <footer>
    <a rel="full-article" href="https://danvatterott.com/data-science-lessons-learned-the-hard-way-coding.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://danvatterott.com/are-some-mlb-players-more-likely-to-hit-into-errors-than-others-data-munging.html">Are some mlb players more likely to hit into errors than others: Data Munging</a>
      </h1>
    <p class="meta">
<time datetime="2019-04-19T11:02:56-05:00" pubdate>Fri 19 April 2019</time>    </p>
</header>

  <div class="entry-content"><p>I recently found myself wondering if some baseball players are more likely to hit into errors than others. In theory, the answer should be "no" since fielders produce errors regardless of who is hitting. Nonetheless, it's also possible that some hitters "force" errors by hitting the ball harder or running …</p></div>
  <footer>
    <a rel="full-article" href="https://danvatterott.com/are-some-mlb-players-more-likely-to-hit-into-errors-than-others-data-munging.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://danvatterott.com/complex-aggregations-in-pyspark.html">Complex Aggregations in PySpark</a>
      </h1>
    <p class="meta">
<time datetime="2019-02-05T19:09:32-06:00" pubdate>Tue 05 February 2019</time>    </p>
</header>

  <div class="entry-content"><p>I've touched on this in <a href="https://danvatterott.com/python-aggregate-udfs-in-pyspark.html">past posts</a>, but wanted to write a post specifically describing the power of what I call complex aggregations in PySpark.</p>
<p>The idea is that you have have a data request which initially seems to require multiple different queries, but using 'complex aggregations' you can create …</p></div>
  <footer>
    <a rel="full-article" href="https://danvatterott.com/complex-aggregations-in-pyspark.html">Read On &crarr;</a>
  </footer>
  		</article>
<div class="pagination">
    <a class="prev" href="https://danvatterott.com/blog2.html">&larr; Older</a>

  <br />
</div></div>
<aside class="sidebar">


<!-- <section> -->
    <section style="max-width: fit-content; margin-inline: auto;">

            <span class="fa-stack fa-lg">
                <a href="mailto:dvatterott@gmail.com"><i class="fa fa-envelope fa-1x"></i></a>
            </span>
            <span class="fa-stack fa-lg">
                <a href="http://www.linkedin.com/in/dan-vatterott"><i class="fa fa-linkedin fa-1x"></i></a>
            </span>

            <span class="fa-stack fa-lg">
                <a href="https://twitter.com/dvatterott"><i class="fa fa-twitter fa-1x"></i></a>
            </span>

            <span class="fa-stack fa-lg">
                <a href="https://github.com/dvatterott"><i class="fa fa-github fa-1x"></i></a>
            </span>
            <span class="fa-stack fa-lg">
                <a href="https://scholar.google.com/citations?hl=en&user=-S7mhDQAAAAJ&hl"><i class="fa fa-graduation-cap fa-1x"></i></a>
            </span>

            <!-- <h1>Social</h1>
                 <ul>
                 <li><a href="dvatterott@gmail.com" target="_blank">email</a></li>
                 <li><a href="http://www.linkedin.com/in/dan-vatterott" target="_blank">linkedin</a></li>
                 <li><a href="https://twitter.com/dvatterott" target="_blank">twitter</a></li>
                 <li><a href="https://github.com/dvatterott" target="_blank">github</a></li>
                 <li><a href="https://scholar.google.com/citations?hl=en&user=-S7mhDQAAAAJ&hl" target="_blank">google-scholar</a></li>


                 </ul> -->
    </section>


  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="https://danvatterott.com/modeling-the-relative-speed-of-hot-wheels-cars.html">Modeling the relative speed of Hot Wheels Cars</a>
      </li>
      <li class="post">
          <a href="https://danvatterott.com/data-onboarding-checklist.html">Data Onboarding Checklist</a>
      </li>
      <li class="post">
          <a href="https://danvatterott.com/posting-collections-as-hive-tables.html">Posting Collections as Hive Tables</a>
      </li>
      <li class="post">
          <a href="https://danvatterott.com/balancing-model-weights-in-pyspark.html">Balancing Model Weights in PySpark</a>
      </li>
      <li class="post">
          <a href="https://danvatterott.com/creating-a-cdf-in-pyspark.html">Creating a CDF in PySpark</a>
      </li>
    </ul>
  </section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2015&ndash;2025  Dan Vatterott &mdash;
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
  <script src="https://danvatterott.com/theme/js/modernizr-2.0.js"></script>
  <script src="https://danvatterott.com/theme/js/ender.js"></script>
  <script src="https://danvatterott.com/theme/js/octopress.js" type="text/javascript"></script>
  <script type="text/javascript">
    var disqus_shortname = 'danvatterott';
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = "//" + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
  </script>
</body>
</html>