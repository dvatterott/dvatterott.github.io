<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Repeated Measures ANOVA in Python (kinda) &mdash; Dan Vatterott</title>
  <meta name="author" content="Dan Vatterott">






  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="/favicon.png" rel="icon">

  <link href="/theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">

  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="/">Dan Vatterott</a></h1>
    <h2>Data Scientist</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>


<ul class="main-navigation">
    <li><a href="/">Home</a></li>
    <li><a href="/about-me.html">About Me</a></li>
    <li><a href="/publications.html">Publications</a></li>
    <li><a href="/Vatterott_Resume.pdf">Resume</a></li>
    <li><a href="/my-reads.html">My Reads</a></li>
    <li><a href="/presentations.html">Presentations</a></li>
    <li><a href="/blog.html">Blog</a></li>
    <li><a href="/archives.html">Archive</a></li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">Repeated Measures ANOVA in Python (kinda)</h1>
    <p class="meta">
<time datetime="2016-02-28T21:52:03-05:00" pubdate>Sun 28 February 2016</time>    </p>
</header>

  <div class="entry-content"><p><em>If you're just finding this post, please check out Erik Marsja's <a href="https://www.marsja.se/repeated-measures-anova-in-python-using-statsmodels/">post</a> describing the same functionality in well-maintained python software that wasn't available when I originally wrote this post.</em></p>
<p>I love doing data analyses with pandas, numpy, sci-py etc., but I often need to run <a href="https://en.wikipedia.org/wiki/Repeated_measures_design">repeated measures ANOVAs</a>, which are not implemented in any major python libraries. <a href="http://pythonpsychologist.tumblr.com/post/139246503057/repeated-measures-anova-using-python">Python Psychologist</a> shows how to do repeated measures ANOVAs yourself in python, but I find using a widley distributed implementation comforting...</p>
<p>In this post I show how to execute a repeated measures ANOVAs using the <a href="http://rpy2.bitbucket.org/">rpy2</a> library, which allows us to move data between python and R, and execute R commands from python. I use rpy2 to load the <a href="http://www.inside-r.org/packages/cran/car/docs/Anova">car</a> library and run the ANOVA.</p>
<p>I will show how to run a one-way repeated measures ANOVA and a two-way repeated measures ANOVA.</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="c1">#first import the libraries I always use.</span>
<span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span><span class="o">,</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="o">,</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="nn">pylab</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<span class="w"> </span><span class="o">%</span><span class="n">matplotlib</span><span class="w"> </span><span class="n">inline</span>
<span class="w"> </span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">mpl_style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;default&#39;</span>
<span class="w"> </span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="w"> </span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Bitstream Vera Sans&#39;</span><span class="p">]</span>
</code></pre></div>

<p>Below I use the random library to generate some fake data. I seed the random number generator with a one so that this analysis can be replicated.</p>
<p>I will generated 3 conditions which represent 3 levels of a single variable.</p>
<p>The data are generated from a gaussian distribution. The second condition has a higher mean than the other two conditions.</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="w"> </span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c1">#seed random number generator</span>
<span class="w"> </span><span class="n">cond_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">)]</span><span class="w"> </span><span class="c1">#condition 1 has a mean of 600 and standard deviation of 30</span>
<span class="w"> </span><span class="n">cond_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">650</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">)]</span><span class="w"> </span><span class="c1">#u=650 and sd=30</span>
<span class="w"> </span><span class="n">cond_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">)]</span><span class="w"> </span><span class="c1">#u=600 and sd=30</span>

<span class="w"> </span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cond_1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cond_2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cond_3</span><span class="p">)],</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span><span class="w"> </span><span class="c1">#plot data</span>
<span class="w"> </span><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span>
</code></pre></div>

<p><img src="/images/rmANOVA_1.png" /></p>
<p>Next, I load rpy2 for ipython. I am doing these analyses with ipython in a <a href="http://jupyter.org/">jupyter notebook</a> (highly recommended).</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="nf">%load_ext</span><span class="w"> </span><span class="n">rpy2</span><span class="p">.</span><span class="n">ipython</span>
</code></pre></div>

<p>Here's how to run the ANOVA. Note that this is a one-way anova with 3 levels of the factor.</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="c1">#pop the data into R</span>
<span class="w"> </span><span class="o">%</span><span class="n">Rpush</span><span class="w"> </span><span class="n">cond_1</span><span class="w"> </span><span class="n">cond_2</span><span class="w"> </span><span class="n">cond_3</span>

<span class="w"> </span><span class="c1">#label the conditions</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">Factor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="s1">&#39;Cond1&#39;</span><span class="p">,</span><span class="s1">&#39;Cond2&#39;</span><span class="p">,</span><span class="s1">&#39;Cond3&#39;</span><span class="p">)</span>
<span class="w"> </span><span class="c1">#create a vector of conditions</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">idata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">Factor</span><span class="p">)</span>

<span class="w"> </span><span class="c1">#combine data into single matrix</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">Bind</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">cond_1</span><span class="p">,</span><span class="n">cond_2</span><span class="p">,</span><span class="n">cond_3</span><span class="p">)</span>
<span class="w"> </span><span class="c1">#generate linear model</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">Bind</span><span class="o">~</span><span class="mi">1</span><span class="p">)</span>

<span class="w"> </span><span class="c1">#load the car library. note this library must be installed.</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>
<span class="w"> </span><span class="c1">#run anova</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">analysis</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Anova</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">idata</span><span class="o">=</span><span class="n">idata</span><span class="p">,</span><span class="n">idesign</span><span class="o">=~</span><span class="n">Factor</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s2">&quot;III&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="c1">#create anova summary table</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">anova_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">summary</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>

<span class="w"> </span><span class="c1">#move the data from R to python</span>
<span class="w"> </span><span class="o">%</span><span class="n">Rpull</span><span class="w"> </span><span class="n">anova_sum</span>
<span class="w"> </span><span class="nb">print</span><span class="w"> </span><span class="n">anova_sum</span>


<span class="n">Type</span><span class="w"> </span><span class="n">III</span><span class="w"> </span><span class="n">Repeated</span><span class="w"> </span><span class="n">Measures</span><span class="w"> </span><span class="n">MANOVA</span><span class="w"> </span><span class="n">Tests</span><span class="p">:</span>

<span class="o">------------------------------------------</span>

<span class="n">Term</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>

<span class="w"> </span><span class="n">Response</span><span class="w"> </span><span class="n">transformation</span><span class="w"> </span><span class="n">matrix</span><span class="p">:</span>
<span class="w">       </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>
<span class="n">cond_1</span><span class="w">           </span><span class="mi">1</span>
<span class="n">cond_2</span><span class="w">           </span><span class="mi">1</span>
<span class="n">cond_3</span><span class="w">           </span><span class="mi">1</span>

<span class="n">Sum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hypothesis</span><span class="p">:</span>
<span class="w">            </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>
<span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w">   </span><span class="mi">102473990</span>

<span class="n">Sum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">error</span><span class="p">:</span>
<span class="w">            </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>
<span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w">     </span><span class="mf">78712.7</span>

<span class="n">Multivariate</span><span class="w"> </span><span class="n">Tests</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>
<span class="w">                 </span><span class="n">Df</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">stat</span><span class="w"> </span><span class="n">approx</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="n">Df</span><span class="w"> </span><span class="n">den</span><span class="w"> </span><span class="n">Df</span><span class="w">     </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span><span class="w">    </span>
<span class="n">Pillai</span><span class="w">            </span><span class="mi">1</span><span class="w">    </span><span class="mf">0.9992</span><span class="w"> </span><span class="mf">37754.33</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.22e-16</span><span class="w"> </span><span class="o">***</span>
<span class="n">Wilks</span><span class="w">             </span><span class="mi">1</span><span class="w">    </span><span class="mf">0.0008</span><span class="w"> </span><span class="mf">37754.33</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.22e-16</span><span class="w"> </span><span class="o">***</span>
<span class="n">Hotelling</span><span class="o">-</span><span class="n">Lawley</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="mf">1301.8736</span><span class="w"> </span><span class="mf">37754.33</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.22e-16</span><span class="w"> </span><span class="o">***</span>
<span class="n">Roy</span><span class="w">               </span><span class="mi">1</span><span class="w"> </span><span class="mf">1301.8736</span><span class="w"> </span><span class="mf">37754.33</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.22e-16</span><span class="w"> </span><span class="o">***</span>
<span class="o">---</span>
<span class="n">Signif</span><span class="o">.</span><span class="w"> </span><span class="n">codes</span><span class="p">:</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="err">‘</span><span class="o">.</span><span class="err">’</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="mi">1</span>

<span class="o">------------------------------------------</span>

<span class="n">Term</span><span class="p">:</span><span class="w"> </span><span class="n">Factor</span>

<span class="w"> </span><span class="n">Response</span><span class="w"> </span><span class="n">transformation</span><span class="w"> </span><span class="n">matrix</span><span class="p">:</span>
<span class="w">       </span><span class="n">Factor1</span><span class="w"> </span><span class="n">Factor2</span>
<span class="n">cond_1</span><span class="w">       </span><span class="mi">1</span><span class="w">       </span><span class="mi">0</span>
<span class="n">cond_2</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">1</span>
<span class="n">cond_3</span><span class="w">      </span><span class="o">-</span><span class="mi">1</span><span class="w">      </span><span class="o">-</span><span class="mi">1</span>

<span class="n">Sum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hypothesis</span><span class="p">:</span>
<span class="w">          </span><span class="n">Factor1</span><span class="w">   </span><span class="n">Factor2</span>
<span class="n">Factor1</span><span class="w">  </span><span class="mf">3679.584</span><span class="w">  </span><span class="mf">19750.87</span>
<span class="n">Factor2</span><span class="w"> </span><span class="mf">19750.870</span><span class="w"> </span><span class="mf">106016.58</span>

<span class="n">Sum</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">error</span><span class="p">:</span>
<span class="w">         </span><span class="n">Factor1</span><span class="w">  </span><span class="n">Factor2</span>
<span class="n">Factor1</span><span class="w"> </span><span class="mf">40463.19</span><span class="w"> </span><span class="mf">27139.59</span>
<span class="n">Factor2</span><span class="w"> </span><span class="mf">27139.59</span><span class="w"> </span><span class="mf">51733.12</span>

<span class="n">Multivariate</span><span class="w"> </span><span class="n">Tests</span><span class="p">:</span><span class="w"> </span><span class="n">Factor</span>
<span class="w">                 </span><span class="n">Df</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">stat</span><span class="w"> </span><span class="n">approx</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="n">Df</span><span class="w"> </span><span class="n">den</span><span class="w"> </span><span class="n">Df</span><span class="w">    </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span><span class="w">    </span>
<span class="n">Pillai</span><span class="w">            </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.7152596</span><span class="w"> </span><span class="mf">35.16759</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">2.303e-08</span><span class="w"> </span><span class="o">***</span>
<span class="n">Wilks</span><span class="w">             </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.2847404</span><span class="w"> </span><span class="mf">35.16759</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">2.303e-08</span><span class="w"> </span><span class="o">***</span>
<span class="n">Hotelling</span><span class="o">-</span><span class="n">Lawley</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="mf">2.5119704</span><span class="w"> </span><span class="mf">35.16759</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">2.303e-08</span><span class="w"> </span><span class="o">***</span>
<span class="n">Roy</span><span class="w">               </span><span class="mi">1</span><span class="w"> </span><span class="mf">2.5119704</span><span class="w"> </span><span class="mf">35.16759</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">2.303e-08</span><span class="w"> </span><span class="o">***</span>
<span class="o">---</span>
<span class="n">Signif</span><span class="o">.</span><span class="w"> </span><span class="n">codes</span><span class="p">:</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="err">‘</span><span class="o">.</span><span class="err">’</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="mi">1</span>

<span class="n">Univariate</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">III</span><span class="w"> </span><span class="n">Repeated</span><span class="o">-</span><span class="n">Measures</span><span class="w"> </span><span class="n">ANOVA</span><span class="w"> </span><span class="n">Assuming</span><span class="w"> </span><span class="n">Sphericity</span>

<span class="w">                  </span><span class="n">SS</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="n">Df</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">SS</span><span class="w"> </span><span class="n">den</span><span class="w"> </span><span class="n">Df</span><span class="w">         </span><span class="n">F</span><span class="w">    </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span><span class="w">    </span>
<span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w"> </span><span class="mi">34157997</span><span class="w">      </span><span class="mi">1</span><span class="w">    </span><span class="mi">26238</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="mf">37754.334</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.2e-16</span><span class="w"> </span><span class="o">***</span>
<span class="n">Factor</span><span class="w">         </span><span class="mi">59964</span><span class="w">      </span><span class="mi">2</span><span class="w">    </span><span class="mi">43371</span><span class="w">     </span><span class="mi">58</span><span class="w">    </span><span class="mf">40.094</span><span class="w"> </span><span class="mf">1.163e-11</span><span class="w"> </span><span class="o">***</span>
<span class="o">---</span>
<span class="n">Signif</span><span class="o">.</span><span class="w"> </span><span class="n">codes</span><span class="p">:</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="err">‘</span><span class="o">.</span><span class="err">’</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="mi">1</span>


<span class="n">Mauchly</span><span class="w"> </span><span class="n">Tests</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Sphericity</span>

<span class="w">       </span><span class="n">Test</span><span class="w"> </span><span class="n">statistic</span><span class="w"> </span><span class="n">p</span><span class="o">-</span><span class="n">value</span>
<span class="n">Factor</span><span class="w">        </span><span class="mf">0.96168</span><span class="w"> </span><span class="mf">0.57866</span>


<span class="n">Greenhouse</span><span class="o">-</span><span class="n">Geisser</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Huynh</span><span class="o">-</span><span class="n">Feldt</span><span class="w"> </span><span class="n">Corrections</span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Departure</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">Sphericity</span>

<span class="w">        </span><span class="n">GG</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">[</span><span class="n">GG</span><span class="p">])</span><span class="w">    </span>
<span class="n">Factor</span><span class="w"> </span><span class="mf">0.96309</span><span class="w">  </span><span class="mf">2.595e-11</span><span class="w"> </span><span class="o">***</span>
<span class="o">---</span>
<span class="n">Signif</span><span class="o">.</span><span class="w"> </span><span class="n">codes</span><span class="p">:</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="err">‘</span><span class="o">.</span><span class="err">’</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="mi">1</span>

<span class="w">        </span><span class="n">HF</span><span class="w"> </span><span class="n">eps</span><span class="w">   </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">[</span><span class="n">HF</span><span class="p">])</span>
<span class="n">Factor</span><span class="w"> </span><span class="mf">1.03025</span><span class="w"> </span><span class="mf">1.163294e-11</span>
</code></pre></div>

<p>The ANOVA table isn't pretty, but it works. As you can see, the ANOVA was wildly significant.</p>
<p>Next, I generate data for a two-way (2x3) repeated measures ANOVA. Condition A is the same data as above. Condition B has a different pattern (2 is lower than 1 and 3), which should produce an interaction.</p>
<div class="highlight"><pre><span></span><code> random.seed(1)

 cond_1a = [random.gauss(600,30) for x in range(30)] #u=600,sd=30
 cond_2a = [random.gauss(650,30) for x in range(30)] #u=650,sd=30
 cond_3a = [random.gauss(600,30) for x in range(30)] #u=600,sd=30

 cond_1b = [random.gauss(600,30) for x in range(30)] #u=600,sd=30
 cond_2b = [random.gauss(550,30) for x in range(30)] #u=550,sd=30
 cond_3b = [random.gauss(650,30) for x in range(30)] #u=650,sd=30

 width = 0.25
 plt.bar(np.arange(1,4)-width,[np.mean(cond_1a),np.mean(cond_2a),np.mean(cond_3a)],width)
 plt.bar(np.arange(1,4),[np.mean(cond_1b),np.mean(cond_2b),np.mean(cond_3b)],width,color=plt.rcParams[&#39;axes.color_cycle&#39;][0])
 plt.legend([&#39;A&#39;,&#39;B&#39;],loc=4)
 plt.xticks([1,2,3]);
</code></pre></div>

<p><img src="/images/rmANOVA_2.png" /></p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="o">%</span><span class="n">Rpush</span><span class="w"> </span><span class="n">cond_1a</span><span class="w"> </span><span class="n">cond_1b</span><span class="w"> </span><span class="n">cond_2a</span><span class="w"> </span><span class="n">cond_2b</span><span class="w"> </span><span class="n">cond_3a</span><span class="w"> </span><span class="n">cond_3b</span>

<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">Factor1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">Factor2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="s1">&#39;Cond1&#39;</span><span class="p">,</span><span class="s1">&#39;Cond2&#39;</span><span class="p">,</span><span class="s1">&#39;Cond3&#39;</span><span class="p">,</span><span class="s1">&#39;Cond1&#39;</span><span class="p">,</span><span class="s1">&#39;Cond2&#39;</span><span class="p">,</span><span class="s1">&#39;Cond3&#39;</span><span class="p">)</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">idata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">data</span><span class="p">.</span><span class="n">frame</span><span class="p">(</span><span class="n">Factor1</span><span class="p">,</span><span class="w"> </span><span class="n">Factor2</span><span class="p">)</span>

<span class="w"> </span><span class="n">#make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">vectors</span><span class="w"> </span><span class="n">appear</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">appear</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">dataframe</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">Bind</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">cond_1a</span><span class="p">,</span><span class="w"> </span><span class="n">cond_2a</span><span class="p">,</span><span class="w"> </span><span class="n">cond_3a</span><span class="p">,</span><span class="w"> </span><span class="n">cond_1b</span><span class="p">,</span><span class="w"> </span><span class="n">cond_2b</span><span class="p">,</span><span class="w"> </span><span class="n">cond_3b</span><span class="p">)</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">Bind</span><span class="o">~</span><span class="mi">1</span><span class="p">)</span>

<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">analysis</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Anova</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">idata</span><span class="o">=</span><span class="n">idata</span><span class="p">,</span><span class="w"> </span><span class="n">idesign</span><span class="o">=~</span><span class="n">Factor1</span><span class="o">*</span><span class="n">Factor2</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="ss">&quot;III&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="o">%</span><span class="n">R</span><span class="w"> </span><span class="n">anova_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">summary</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>
<span class="w"> </span><span class="o">%</span><span class="n">Rpull</span><span class="w"> </span><span class="n">anova_sum</span>

<span class="w"> </span><span class="k">print</span><span class="w"> </span><span class="n">anova_sum</span>


<span class="n">Type</span><span class="w"> </span><span class="n">III</span><span class="w"> </span><span class="n">Repeated</span><span class="w"> </span><span class="n">Measures</span><span class="w"> </span><span class="n">MANOVA</span><span class="w"> </span><span class="nl">Tests</span><span class="p">:</span>

<span class="o">------------------------------------------</span>

<span class="nl">Term</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>

<span class="w"> </span><span class="n">Response</span><span class="w"> </span><span class="n">transformation</span><span class="w"> </span><span class="nl">matrix</span><span class="p">:</span>
<span class="w">        </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>
<span class="n">cond_1a</span><span class="w">           </span><span class="mi">1</span>
<span class="n">cond_2a</span><span class="w">           </span><span class="mi">1</span>
<span class="n">cond_3a</span><span class="w">           </span><span class="mi">1</span>
<span class="n">cond_1b</span><span class="w">           </span><span class="mi">1</span>
<span class="n">cond_2b</span><span class="w">           </span><span class="mi">1</span>
<span class="n">cond_3b</span><span class="w">           </span><span class="mi">1</span>

<span class="nf">Sum</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nl">hypothesis</span><span class="p">:</span>
<span class="w">            </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>
<span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w">   </span><span class="mi">401981075</span>

<span class="nf">Sum</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nl">error</span><span class="p">:</span>
<span class="w">            </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>
<span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w">    </span><span class="mf">185650.5</span>

<span class="n">Multivariate</span><span class="w"> </span><span class="nl">Tests</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>
<span class="w">                 </span><span class="n">Df</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">stat</span><span class="w"> </span><span class="n">approx</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="n">Df</span><span class="w"> </span><span class="n">den</span><span class="w"> </span><span class="n">Df</span><span class="w">     </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span><span class="w">    </span>
<span class="n">Pillai</span><span class="w">            </span><span class="mi">1</span><span class="w">    </span><span class="mf">0.9995</span><span class="w"> </span><span class="mf">62792.47</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.22e-16</span><span class="w"> </span><span class="o">***</span>
<span class="n">Wilks</span><span class="w">             </span><span class="mi">1</span><span class="w">    </span><span class="mf">0.0005</span><span class="w"> </span><span class="mf">62792.47</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.22e-16</span><span class="w"> </span><span class="o">***</span>
<span class="n">Hotelling</span><span class="o">-</span><span class="n">Lawley</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="mf">2165.2575</span><span class="w"> </span><span class="mf">62792.47</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.22e-16</span><span class="w"> </span><span class="o">***</span>
<span class="n">Roy</span><span class="w">               </span><span class="mi">1</span><span class="w"> </span><span class="mf">2165.2575</span><span class="w"> </span><span class="mf">62792.47</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.22e-16</span><span class="w"> </span><span class="o">***</span>
<span class="o">---</span>
<span class="n">Signif</span><span class="p">.</span><span class="w"> </span><span class="nl">codes</span><span class="p">:</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="err">‘</span><span class="p">.</span><span class="err">’</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="mi">1</span>

<span class="o">------------------------------------------</span>

<span class="nl">Term</span><span class="p">:</span><span class="w"> </span><span class="n">Factor1</span>

<span class="w"> </span><span class="n">Response</span><span class="w"> </span><span class="n">transformation</span><span class="w"> </span><span class="nl">matrix</span><span class="p">:</span>
<span class="w">        </span><span class="n">Factor11</span>
<span class="n">cond_1a</span><span class="w">        </span><span class="mi">1</span>
<span class="n">cond_2a</span><span class="w">        </span><span class="mi">1</span>
<span class="n">cond_3a</span><span class="w">        </span><span class="mi">1</span>
<span class="n">cond_1b</span><span class="w">       </span><span class="o">-</span><span class="mi">1</span>
<span class="n">cond_2b</span><span class="w">       </span><span class="o">-</span><span class="mi">1</span>
<span class="n">cond_3b</span><span class="w">       </span><span class="o">-</span><span class="mi">1</span>

<span class="nf">Sum</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nl">hypothesis</span><span class="p">:</span>
<span class="w">         </span><span class="n">Factor11</span>
<span class="n">Factor11</span><span class="w"> </span><span class="mf">38581.51</span>

<span class="nf">Sum</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nl">error</span><span class="p">:</span>
<span class="w">         </span><span class="n">Factor11</span>
<span class="n">Factor11</span><span class="w"> </span><span class="mf">142762.3</span>

<span class="n">Multivariate</span><span class="w"> </span><span class="nl">Tests</span><span class="p">:</span><span class="w"> </span><span class="n">Factor1</span>
<span class="w">                 </span><span class="n">Df</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">stat</span><span class="w"> </span><span class="n">approx</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="n">Df</span><span class="w"> </span><span class="n">den</span><span class="w"> </span><span class="n">Df</span><span class="w">    </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span><span class="w">   </span>
<span class="n">Pillai</span><span class="w">            </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.2127533</span><span class="w"> </span><span class="mf">7.837247</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="mf">0.0090091</span><span class="w"> </span><span class="o">**</span>
<span class="n">Wilks</span><span class="w">             </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.7872467</span><span class="w"> </span><span class="mf">7.837247</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="mf">0.0090091</span><span class="w"> </span><span class="o">**</span>
<span class="n">Hotelling</span><span class="o">-</span><span class="n">Lawley</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.2702499</span><span class="w"> </span><span class="mf">7.837247</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="mf">0.0090091</span><span class="w"> </span><span class="o">**</span>
<span class="n">Roy</span><span class="w">               </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.2702499</span><span class="w"> </span><span class="mf">7.837247</span><span class="w">      </span><span class="mi">1</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="mf">0.0090091</span><span class="w"> </span><span class="o">**</span>
<span class="o">---</span>
<span class="n">Signif</span><span class="p">.</span><span class="w"> </span><span class="nl">codes</span><span class="p">:</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="err">‘</span><span class="p">.</span><span class="err">’</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="mi">1</span>

<span class="o">------------------------------------------</span>

<span class="nl">Term</span><span class="p">:</span><span class="w"> </span><span class="n">Factor2</span>

<span class="w"> </span><span class="n">Response</span><span class="w"> </span><span class="n">transformation</span><span class="w"> </span><span class="nl">matrix</span><span class="p">:</span>
<span class="w">        </span><span class="n">Factor21</span><span class="w"> </span><span class="n">Factor22</span>
<span class="n">cond_1a</span><span class="w">        </span><span class="mi">1</span><span class="w">        </span><span class="mi">0</span>
<span class="n">cond_2a</span><span class="w">        </span><span class="mi">0</span><span class="w">        </span><span class="mi">1</span>
<span class="n">cond_3a</span><span class="w">       </span><span class="o">-</span><span class="mi">1</span><span class="w">       </span><span class="o">-</span><span class="mi">1</span>
<span class="n">cond_1b</span><span class="w">        </span><span class="mi">1</span><span class="w">        </span><span class="mi">0</span>
<span class="n">cond_2b</span><span class="w">        </span><span class="mi">0</span><span class="w">        </span><span class="mi">1</span>
<span class="n">cond_3b</span><span class="w">       </span><span class="o">-</span><span class="mi">1</span><span class="w">       </span><span class="o">-</span><span class="mi">1</span>

<span class="nf">Sum</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nl">hypothesis</span><span class="p">:</span>
<span class="w">         </span><span class="n">Factor21</span><span class="w"> </span><span class="n">Factor22</span>
<span class="n">Factor21</span><span class="w"> </span><span class="mf">91480.01</span><span class="w"> </span><span class="mf">77568.78</span>
<span class="n">Factor22</span><span class="w"> </span><span class="mf">77568.78</span><span class="w"> </span><span class="mf">65773.02</span>

<span class="nf">Sum</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nl">error</span><span class="p">:</span>
<span class="w">         </span><span class="n">Factor21</span><span class="w"> </span><span class="n">Factor22</span>
<span class="n">Factor21</span><span class="w"> </span><span class="mf">90374.60</span><span class="w"> </span><span class="mf">56539.06</span>
<span class="n">Factor22</span><span class="w"> </span><span class="mf">56539.06</span><span class="w"> </span><span class="mf">87589.85</span>

<span class="n">Multivariate</span><span class="w"> </span><span class="nl">Tests</span><span class="p">:</span><span class="w"> </span><span class="n">Factor2</span>
<span class="w">                 </span><span class="n">Df</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">stat</span><span class="w"> </span><span class="n">approx</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="n">Df</span><span class="w"> </span><span class="n">den</span><span class="w"> </span><span class="n">Df</span><span class="w">    </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span><span class="w">    </span>
<span class="n">Pillai</span><span class="w">            </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.5235423</span><span class="w"> </span><span class="mf">15.38351</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">3.107e-05</span><span class="w"> </span><span class="o">***</span>
<span class="n">Wilks</span><span class="w">             </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.4764577</span><span class="w"> </span><span class="mf">15.38351</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">3.107e-05</span><span class="w"> </span><span class="o">***</span>
<span class="n">Hotelling</span><span class="o">-</span><span class="n">Lawley</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="mf">1.0988223</span><span class="w"> </span><span class="mf">15.38351</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">3.107e-05</span><span class="w"> </span><span class="o">***</span>
<span class="n">Roy</span><span class="w">               </span><span class="mi">1</span><span class="w"> </span><span class="mf">1.0988223</span><span class="w"> </span><span class="mf">15.38351</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">3.107e-05</span><span class="w"> </span><span class="o">***</span>
<span class="o">---</span>
<span class="n">Signif</span><span class="p">.</span><span class="w"> </span><span class="nl">codes</span><span class="p">:</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="err">‘</span><span class="p">.</span><span class="err">’</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="mi">1</span>

<span class="o">------------------------------------------</span>

<span class="nl">Term</span><span class="p">:</span><span class="w"> </span><span class="nl">Factor1</span><span class="p">:</span><span class="n">Factor2</span>

<span class="w"> </span><span class="n">Response</span><span class="w"> </span><span class="n">transformation</span><span class="w"> </span><span class="nl">matrix</span><span class="p">:</span>
<span class="w">        </span><span class="nl">Factor11</span><span class="p">:</span><span class="n">Factor21</span><span class="w"> </span><span class="nl">Factor11</span><span class="p">:</span><span class="n">Factor22</span>
<span class="n">cond_1a</span><span class="w">                 </span><span class="mi">1</span><span class="w">                 </span><span class="mi">0</span>
<span class="n">cond_2a</span><span class="w">                 </span><span class="mi">0</span><span class="w">                 </span><span class="mi">1</span>
<span class="n">cond_3a</span><span class="w">                </span><span class="o">-</span><span class="mi">1</span><span class="w">                </span><span class="o">-</span><span class="mi">1</span>
<span class="n">cond_1b</span><span class="w">                </span><span class="o">-</span><span class="mi">1</span><span class="w">                 </span><span class="mi">0</span>
<span class="n">cond_2b</span><span class="w">                 </span><span class="mi">0</span><span class="w">                </span><span class="o">-</span><span class="mi">1</span>
<span class="n">cond_3b</span><span class="w">                 </span><span class="mi">1</span><span class="w">                 </span><span class="mi">1</span>

<span class="nf">Sum</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nl">hypothesis</span><span class="p">:</span>
<span class="w">                  </span><span class="nl">Factor11</span><span class="p">:</span><span class="n">Factor21</span><span class="w"> </span><span class="nl">Factor11</span><span class="p">:</span><span class="n">Factor22</span>
<span class="nl">Factor11</span><span class="p">:</span><span class="n">Factor21</span><span class="w">          </span><span class="mf">179585.9</span><span class="w">            </span><span class="mi">384647</span>
<span class="nl">Factor11</span><span class="p">:</span><span class="n">Factor22</span><span class="w">          </span><span class="mf">384647.0</span><span class="w">            </span><span class="mi">823858</span>

<span class="nf">Sum</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">squares</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nl">error</span><span class="p">:</span>
<span class="w">                  </span><span class="nl">Factor11</span><span class="p">:</span><span class="n">Factor21</span><span class="w"> </span><span class="nl">Factor11</span><span class="p">:</span><span class="n">Factor22</span>
<span class="nl">Factor11</span><span class="p">:</span><span class="n">Factor21</span><span class="w">          </span><span class="mf">92445.33</span><span class="w">          </span><span class="mf">45639.49</span>
<span class="nl">Factor11</span><span class="p">:</span><span class="n">Factor22</span><span class="w">          </span><span class="mf">45639.49</span><span class="w">          </span><span class="mf">89940.37</span>

<span class="n">Multivariate</span><span class="w"> </span><span class="nl">Tests</span><span class="p">:</span><span class="w"> </span><span class="nl">Factor1</span><span class="p">:</span><span class="n">Factor2</span>
<span class="w">                 </span><span class="n">Df</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">stat</span><span class="w"> </span><span class="n">approx</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="n">Df</span><span class="w"> </span><span class="n">den</span><span class="w"> </span><span class="n">Df</span><span class="w">     </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span><span class="w">    </span>
<span class="n">Pillai</span><span class="w">            </span><span class="mi">1</span><span class="w">  </span><span class="mf">0.901764</span><span class="w"> </span><span class="mf">128.5145</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">7.7941e-15</span><span class="w"> </span><span class="o">***</span>
<span class="n">Wilks</span><span class="w">             </span><span class="mi">1</span><span class="w">  </span><span class="mf">0.098236</span><span class="w"> </span><span class="mf">128.5145</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">7.7941e-15</span><span class="w"> </span><span class="o">***</span>
<span class="n">Hotelling</span><span class="o">-</span><span class="n">Lawley</span><span class="w">  </span><span class="mi">1</span><span class="w">  </span><span class="mf">9.179605</span><span class="w"> </span><span class="mf">128.5145</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">7.7941e-15</span><span class="w"> </span><span class="o">***</span>
<span class="n">Roy</span><span class="w">               </span><span class="mi">1</span><span class="w">  </span><span class="mf">9.179605</span><span class="w"> </span><span class="mf">128.5145</span><span class="w">      </span><span class="mi">2</span><span class="w">     </span><span class="mi">28</span><span class="w"> </span><span class="mf">7.7941e-15</span><span class="w"> </span><span class="o">***</span>
<span class="o">---</span>
<span class="n">Signif</span><span class="p">.</span><span class="w"> </span><span class="nl">codes</span><span class="p">:</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="err">‘</span><span class="p">.</span><span class="err">’</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="mi">1</span>

<span class="n">Univariate</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">III</span><span class="w"> </span><span class="n">Repeated</span><span class="o">-</span><span class="n">Measures</span><span class="w"> </span><span class="n">ANOVA</span><span class="w"> </span><span class="n">Assuming</span><span class="w"> </span><span class="n">Sphericity</span>

<span class="w">                      </span><span class="n">SS</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="n">Df</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">SS</span><span class="w"> </span><span class="n">den</span><span class="w"> </span><span class="n">Df</span><span class="w">          </span><span class="n">F</span><span class="w">    </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="p">)</span><span class="w">    </span>
<span class="p">(</span><span class="n">Intercept</span><span class="p">)</span><span class="w">     </span><span class="mi">66996846</span><span class="w">      </span><span class="mi">1</span><span class="w">    </span><span class="mi">30942</span><span class="w">     </span><span class="mi">29</span><span class="w"> </span><span class="mf">62792.4662</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.2e-16</span><span class="w"> </span><span class="o">***</span>
<span class="n">Factor1</span><span class="w">             </span><span class="mi">6430</span><span class="w">      </span><span class="mi">1</span><span class="w">    </span><span class="mi">23794</span><span class="w">     </span><span class="mi">29</span><span class="w">     </span><span class="mf">7.8372</span><span class="w">  </span><span class="mf">0.009009</span><span class="w"> </span><span class="o">**</span>
<span class="n">Factor2</span><span class="w">            </span><span class="mi">26561</span><span class="w">      </span><span class="mi">2</span><span class="w">    </span><span class="mi">40475</span><span class="w">     </span><span class="mi">58</span><span class="w">    </span><span class="mf">19.0310</span><span class="w">  </span><span class="mf">4.42e-07</span><span class="w"> </span><span class="o">***</span>
<span class="nl">Factor1</span><span class="p">:</span><span class="n">Factor2</span><span class="w">   </span><span class="mi">206266</span><span class="w">      </span><span class="mi">2</span><span class="w">    </span><span class="mi">45582</span><span class="w">     </span><span class="mi">58</span><span class="w">   </span><span class="mf">131.2293</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.2e-16</span><span class="w"> </span><span class="o">***</span>
<span class="o">---</span>
<span class="n">Signif</span><span class="p">.</span><span class="w"> </span><span class="nl">codes</span><span class="p">:</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="err">‘</span><span class="p">.</span><span class="err">’</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="mi">1</span>


<span class="n">Mauchly</span><span class="w"> </span><span class="n">Tests</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Sphericity</span>

<span class="w">                </span><span class="n">Test</span><span class="w"> </span><span class="n">statistic</span><span class="w"> </span><span class="n">p</span><span class="o">-</span><span class="k">value</span>
<span class="n">Factor2</span><span class="w">                </span><span class="mf">0.96023</span><span class="w"> </span><span class="mf">0.56654</span>
<span class="nl">Factor1</span><span class="p">:</span><span class="n">Factor2</span><span class="w">        </span><span class="mf">0.99975</span><span class="w"> </span><span class="mf">0.99648</span>


<span class="n">Greenhouse</span><span class="o">-</span><span class="n">Geisser</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Huynh</span><span class="o">-</span><span class="n">Feldt</span><span class="w"> </span><span class="n">Corrections</span>
<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Departure</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Sphericity</span>

<span class="w">                 </span><span class="n">GG</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="o">[</span><span class="n">GG</span><span class="o">]</span><span class="p">)</span><span class="w">    </span>
<span class="n">Factor2</span><span class="w">         </span><span class="mf">0.96175</span><span class="w">  </span><span class="mf">6.876e-07</span><span class="w"> </span><span class="o">***</span>
<span class="nl">Factor1</span><span class="p">:</span><span class="n">Factor2</span><span class="w"> </span><span class="mf">0.99975</span><span class="w">  </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">2.2e-16</span><span class="w"> </span><span class="o">***</span>
<span class="o">---</span>
<span class="n">Signif</span><span class="p">.</span><span class="w"> </span><span class="nl">codes</span><span class="p">:</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="err">‘</span><span class="o">***</span><span class="err">’</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="err">‘</span><span class="o">**</span><span class="err">’</span><span class="w"> </span><span class="mf">0.01</span><span class="w"> </span><span class="err">‘</span><span class="o">*</span><span class="err">’</span><span class="w"> </span><span class="mf">0.05</span><span class="w"> </span><span class="err">‘</span><span class="p">.</span><span class="err">’</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="err">‘</span><span class="w"> </span><span class="err">’</span><span class="w"> </span><span class="mi">1</span>

<span class="w">                  </span><span class="n">HF</span><span class="w"> </span><span class="n">eps</span><span class="w">   </span><span class="n">Pr</span><span class="p">(</span><span class="o">&gt;</span><span class="n">F</span><span class="o">[</span><span class="n">HF</span><span class="o">]</span><span class="p">)</span>
<span class="n">Factor2</span><span class="w">         </span><span class="mf">1.028657</span><span class="w"> </span><span class="mf">4.420005e-07</span>
<span class="nl">Factor1</span><span class="p">:</span><span class="n">Factor2</span><span class="w"> </span><span class="mf">1.073774</span><span class="w"> </span><span class="mf">2.965002e-22</span>
</code></pre></div>

<p>Again, the anova table isn't too pretty.</p>
<p>This obviously isn't the most exciting post in the world, but its a nice bit of code to have in your back pocket if you're doing experimental analyses in python.</p></div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">
        Dan Vatterott
    </span>
  </span>
<time datetime="2016-02-28T21:52:03-05:00" pubdate>Sun 28 February 2016</time>  <span class="categories">
    <a class='category' href='/category/misc.html'>misc</a>
  </span>
</p><div class="sharing">
</div>    </footer>
  </article>

</div>
<aside class="sidebar">


<!-- <section> -->
    <section style="max-width: fit-content; margin-inline: auto;">

            <span class="fa-stack fa-lg">
                <a href="mailto:dvatterott@gmail.com"><i class="fa fa-envelope fa-1x"></i></a>
            </span>
            <span class="fa-stack fa-lg">
                <a href="http://www.linkedin.com/in/dan-vatterott"><i class="fa fa-linkedin fa-1x"></i></a>
            </span>

            <span class="fa-stack fa-lg">
                <a href="https://twitter.com/dvatterott"><i class="fa fa-twitter fa-1x"></i></a>
            </span>

            <span class="fa-stack fa-lg">
                <a href="https://github.com/dvatterott"><i class="fa fa-github fa-1x"></i></a>
            </span>
            <span class="fa-stack fa-lg">
                <a href="https://scholar.google.com/citations?hl=en&user=-S7mhDQAAAAJ&hl"><i class="fa fa-graduation-cap fa-1x"></i></a>
            </span>

            <!-- <h1>Social</h1>
                 <ul>
                 <li><a href="dvatterott@gmail.com" target="_blank">email</a></li>
                 <li><a href="http://www.linkedin.com/in/dan-vatterott" target="_blank">linkedin</a></li>
                 <li><a href="https://twitter.com/dvatterott" target="_blank">twitter</a></li>
                 <li><a href="https://github.com/dvatterott" target="_blank">github</a></li>
                 <li><a href="https://scholar.google.com/citations?hl=en&user=-S7mhDQAAAAJ&hl" target="_blank">google-scholar</a></li>


                 </ul> -->
    </section>


  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="/modeling-the-relative-speed-of-hot-wheels-cars.html">Modeling the relative speed of Hot Wheels Cars</a>
      </li>
      <li class="post">
          <a href="/data-onboarding-checklist.html">Data Onboarding Checklist</a>
      </li>
      <li class="post">
          <a href="/posting-collections-as-hive-tables.html">Posting Collections as Hive Tables</a>
      </li>
      <li class="post">
          <a href="/balancing-model-weights-in-pyspark.html">Balancing Model Weights in PySpark</a>
      </li>
      <li class="post">
          <a href="/creating-a-cdf-in-pyspark.html">Creating a CDF in PySpark</a>
      </li>
    </ul>
  </section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2015&ndash;2025  Dan Vatterott &mdash;
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
  <script src="/theme/js/modernizr-2.0.js"></script>
  <script src="/theme/js/ender.js"></script>
  <script src="/theme/js/octopress.js" type="text/javascript"></script>
  <script type="text/javascript">
    var disqus_shortname = 'danvatterott';
    var disqus_identifier = '/repeated-measures-anova-in-python-kinda.html';
    var disqus_url = '/repeated-measures-anova-in-python-kinda.html';
    var disqus_title = 'Repeated Measures ANOVA in Python (kinda)';
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = "//" + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
  </script>
</body>
</html>